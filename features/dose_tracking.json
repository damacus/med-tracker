[
  {"id": "DOSE-001", "category": "functional", "area": "dose_tracking", "description": "Record medication take for prescription", "steps": ["Log in", "Navigate to prescription", "Click Take Medicine", "Verify MedicationTake created", "Verify taken_at set", "Verify administered_by set"], "passes": true},
  {"id": "DOSE-002", "category": "functional", "area": "dose_tracking", "description": "Record medication take with notes", "steps": ["Log in", "Navigate to prescription", "Click Take Medicine", "Add notes", "Submit", "Verify notes saved"], "passes": true},
  {"id": "DOSE-003", "category": "functional", "area": "dose_tracking", "description": "Record medication take with amount", "steps": ["Log in", "Navigate to prescription", "Click Take Medicine", "Enter amount_ml", "Submit", "Verify amount saved"], "passes": true},
  {"id": "DOSE-004", "category": "functional", "area": "dose_tracking", "description": "Max daily doses restriction prevents extra doses", "steps": ["Create prescription max_daily_doses=2", "Take first dose - succeeds", "Take second dose - succeeds", "Attempt third dose - blocked", "Verify error message"], "passes": true},
  {"id": "DOSE-005", "category": "functional", "area": "dose_tracking", "description": "Min hours between doses restriction prevents early doses", "steps": ["Create prescription min_hours_between_doses=4", "Take first dose", "Immediately attempt second", "Verify blocked", "Verify next_available_time shown"], "passes": true},
  {"id": "DOSE-006", "category": "functional", "area": "dose_tracking", "description": "Take button disabled when restrictions prevent taking", "steps": ["Create prescription with restrictions", "Take dose to trigger restriction", "Navigate to prescription page", "Verify Take button disabled", "Verify next available time displayed"], "passes": true},
  {"id": "DOSE-007", "category": "functional", "area": "dose_tracking", "description": "can_take_now? returns false when daily limit reached", "steps": ["Create prescription max_daily_doses=1", "Take one dose", "Call can_take_now?", "Verify returns false"], "passes": true},
  {"id": "DOSE-008", "category": "functional", "area": "dose_tracking", "description": "can_take_now? returns false when min hours not elapsed", "steps": ["Create prescription min_hours_between_doses=4", "Take one dose", "Call can_take_now?", "Verify returns false"], "passes": true},
  {"id": "DOSE-009", "category": "functional", "area": "dose_tracking", "description": "next_available_time calculates correctly", "steps": ["Create prescription min_hours_between_doses=4", "Take dose at 10:00", "Call next_available_time", "Verify returns 14:00"], "passes": true},
  {"id": "DOSE-010", "category": "functional", "area": "dose_tracking", "description": "Daily dose count resets at midnight", "steps": ["Create prescription max_daily_doses=2", "Take 2 doses today", "Verify can_take_now? false", "Advance to next day", "Verify can_take_now? true"], "passes": true},
  {"id": "DOSE-011", "category": "functional", "area": "dose_tracking", "description": "MedicationTake requires exactly one of prescription_id or person_medicine_id", "steps": ["Attempt create with neither", "Verify error", "Attempt create with both", "Verify error", "Create with only prescription_id - succeeds"], "passes": true},
  {"id": "DOSE-012", "category": "functional", "area": "dose_tracking", "description": "View medication take history for prescription", "steps": ["Log in", "Navigate to prescription", "View history", "Verify all takes listed", "Verify timestamps shown", "Verify administered_by shown"], "passes": true},
  {"id": "DOSE-013", "category": "functional", "area": "dose_tracking", "description": "Complete dose tracking workflow with restrictions", "steps": ["Log in as carer with assigned patient", "Navigate to patient's prescription with max_daily_doses=3 and min_hours_between_doses=4", "Verify can_take_now? is true", "Click Take Medicine", "Add notes: First dose of day", "Submit", "Verify MedicationTake created", "Verify taken_at timestamp correct", "Verify administered_by set to carer", "Immediately click Take Medicine again", "Verify blocked due to min_hours restriction", "Verify next_available_time displayed", "Verify button is disabled", "Navigate to medication history", "Verify first dose appears", "Verify notes displayed"], "passes": false},
  {"id": "DOSE-014", "category": "functional", "area": "dose_tracking", "description": "Dose tracking across multiple prescriptions", "steps": ["Log in as nurse", "Navigate to patient with multiple active prescriptions", "Select first prescription (Paracetamol)", "Click Take Medicine", "Verify recorded for Paracetamol", "Navigate back to patient", "Select second prescription (Ibuprofen)", "Click Take Medicine", "Verify recorded for Ibuprofen", "Navigate to patient medication history", "Verify both doses appear", "Verify correct prescription linked to each", "Verify timestamps are different", "Verify administered_by shows nurse for both"], "passes": false}
]
