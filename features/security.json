[
  {"id": "2FA-001", "category": "functional", "area": "security", "description": "User can enable two-factor authentication", "steps": ["Log in", "Navigate to security settings", "Click Enable 2FA", "Scan QR code with authenticator app", "Enter TOTP code from app", "Verify 2FA enabled", "Verify success message"], "passes": false},
  {"id": "2FA-002", "category": "functional", "area": "security", "description": "User with 2FA must enter code on login", "steps": ["Enable 2FA for user", "Log out", "Log in with email and password", "Verify prompted for TOTP code", "Enter valid code from authenticator", "Verify logged in to dashboard"], "passes": false},
  {"id": "2FA-003", "category": "functional", "area": "security", "description": "User receives backup codes when enabling 2FA", "steps": ["Enable 2FA", "Verify 10 backup codes displayed", "Verify codes can be downloaded as text file", "Verify warning to store codes safely"], "passes": false},
  {"id": "2FA-004", "category": "functional", "area": "security", "description": "User can use backup code instead of TOTP", "steps": ["Enable 2FA", "Log out", "Log in with password", "Click Use backup code", "Enter backup code", "Verify logged in", "Verify backup code invalidated for future use"], "passes": false},
  {"id": "2FA-005", "category": "functional", "area": "security", "description": "User can disable two-factor authentication", "steps": ["Enable 2FA", "Navigate to security settings", "Click Disable 2FA", "Enter TOTP code to confirm", "Verify 2FA disabled", "Verify login no longer requires 2FA"], "passes": false},
  {"id": "SEC-001", "category": "functional", "area": "security", "description": "CSRF protection enabled", "steps": ["Inspect form HTML", "Verify CSRF token present in hidden field", "Submit form without token via curl", "Verify request rejected with 422"], "passes": true},
  {"id": "SEC-002", "category": "functional", "area": "security", "description": "Password minimum 8 characters", "steps": ["Navigate to signup", "Enter 7 character password", "Submit", "Verify validation error displayed", "Enter 8 character password", "Verify accepted"], "passes": true},
  {"id": "SEC-003", "category": "functional", "area": "security", "description": "SQL injection prevented", "steps": ["Navigate to admin user search", "Enter: ' OR '1'='1", "Submit search", "Verify no SQL error", "Verify no unauthorized data returned"], "passes": true},
  {"id": "SEC-004", "category": "functional", "area": "security", "description": "XSS prevented", "steps": ["Navigate to person form", "Enter name: <script>alert('xss')</script>", "Submit", "View person details page", "Verify script tag escaped and displayed as text"], "passes": true},
  {"id": "SEC-005", "category": "functional", "area": "security", "description": "Session fixation prevented", "steps": ["Note session cookie value before login", "Log in with valid credentials", "Note session cookie value after login", "Verify session ID changed"], "passes": true},
  {"id": "SEC-006", "category": "functional", "area": "security", "description": "Passwords not logged", "steps": ["Create user with password 'TestPassword123'", "Check Rails application logs", "Verify password not in plaintext in logs", "Verify password_digest filtered"], "passes": true},
  {"id": "SEC-007", "category": "functional", "area": "security", "description": "Failed login attempts tracked and account lockout", "steps": ["Attempt login with wrong password", "Repeat 5 times", "Verify failed attempts recorded in database", "Attempt 6th login", "Verify account locked message", "Verify cannot login even with correct password"], "passes": false},
  {"id": "SEC-008", "category": "functional", "area": "security", "description": "Secure cookies in production", "steps": ["Set RAILS_ENV=production", "Log in", "Inspect Set-Cookie header", "Verify Secure flag present", "Verify HttpOnly flag present", "Verify SameSite attribute set"], "passes": true},
  {"id": "SEC-009", "category": "functional", "area": "security", "description": "Content Security Policy headers set", "steps": ["Make request to any page", "Inspect response headers", "Verify Content-Security-Policy header present", "Verify script-src directive set", "Verify style-src directive set"], "passes": true},
  {"id": "SEC-010", "category": "functional", "area": "security", "description": "Rate limiting on login endpoint", "steps": ["Attempt 100 login requests in 1 minute via script", "Verify rate limited after threshold", "Verify 429 Too Many Requests response", "Wait for rate limit to reset", "Verify can login again"], "passes": false},
  {"id": "SEC-011", "category": "functional", "area": "security", "description": "Admin impersonation logs action", "steps": ["Log in as administrator", "Navigate to user list", "Click Impersonate on user", "Verify impersonation banner shown", "Perform action as impersonated user", "End impersonation", "Check audit logs", "Verify impersonation logged"], "passes": false},
  {"id": "SEC-012", "category": "functional", "area": "security", "description": "Bcrypt password hashing used", "steps": ["Create user with password", "Query database for password_hash", "Verify hash starts with $2a$ or $2b$ (bcrypt prefix)", "Verify hash length is 60 characters"], "passes": true},
  {"id": "SEC-013", "category": "functional", "area": "security", "description": "Remember me tokens rotated on use", "steps": ["Log in with Remember Me checked", "Note remember token value", "Close and reopen browser", "Verify auto-logged in", "Note new remember token value", "Verify token changed"], "passes": false},
  {"id": "SEC-014", "category": "functional", "area": "security", "description": "Strong parameters prevent mass assignment", "steps": ["Attempt to create user via API with role=administrator", "Verify role not set to administrator", "Verify only permitted params accepted"], "passes": true},
  {"id": "SEC-015", "category": "functional", "area": "security", "description": "Encrypted database connections in production", "steps": ["Check database.yml production config", "Verify sslmode=require or equivalent", "Verify connection uses TLS"], "passes": true}
]
