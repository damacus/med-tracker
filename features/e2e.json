[
	{
		"id": "E2E-001",
		"category": "functional",
		"area": "e2e",
		"description": "Complete user signup to medication recording flow",
		"steps": [
			"Navigate to /create-account",
			"Fill in email, password, name, date of birth",
			"Submit signup form",
			"Verify redirect to dashboard",
			"Navigate to person medicines",
			"Add new OTC medicine (Vitamin D)",
			"Set max_daily_doses to 2",
			"Click Take Medicine",
			"Verify MedicationTake created",
			"Verify dose count shows 1/2",
			"Log out",
			"Verify redirect to home page"
		],
		"passes": true
	},
	{
		"id": "E2E-002",
		"category": "functional",
		"area": "e2e",
		"description": "Admin creates user and assigns as carer for dependent adult",
		"steps": [
			"Log in as administrator (damacus@example.com)",
			"Navigate to /admin/users",
			"Click New User",
			"Fill in carer details (email, password, name, DOB)",
			"Select role: carer",
			"Submit form",
			"Verify user created",
			"Navigate to carer relationships",
			"Click New Relationship",
			"Select new carer",
			"Select dependent adult patient",
			"Select relationship type: Professional Carer",
			"Submit",
			"Verify relationship created",
			"Log out",
			"Log in as new carer",
			"Navigate to dashboard",
			"Verify assigned patient visible",
			"Navigate to patient prescriptions",
			"Click Take Medicine",
			"Verify recorded",
			"Log out"
		],
		"passes": true
	},
	{
		"id": "E2E-003",
		"category": "functional",
		"area": "e2e",
		"description": "Doctor creates prescription with timing restrictions and carer administers",
		"steps": [
			"Log in as doctor (dr.jones@example.com)",
			"Navigate to /people",
			"Click New Person",
			"Create patient: name, DOB, person_type=dependent_adult, has_capacity=false",
			"Submit",
			"Navigate to patient prescriptions",
			"Click New Prescription",
			"Select medicine: Paracetamol",
			"Set dosage: 500mg",
			"Set frequency: Every 4 hours as needed",
			"Set max_daily_doses: 4",
			"Set min_hours_between_doses: 4",
			"Submit prescription",
			"Navigate to carer relationships",
			"Assign existing carer to patient",
			"Log out",
			"Log in as assigned carer",
			"Navigate to dashboard",
			"Find patient prescription",
			"Click Take Medicine",
			"Verify first dose recorded",
			"Immediately click Take Medicine again",
			"Verify blocked with message",
			"Verify next_available_time displayed",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-004",
		"category": "functional",
		"area": "e2e",
		"description": "Parent manages child's OTC medicine with daily limits",
		"steps": [
			"Log in as parent (jane.doe@example.com)",
			"Navigate to dashboard",
			"Find child in list",
			"Navigate to child's person medicines",
			"Click Add Medicine",
			"Select Vitamin C",
			"Add notes: Daily supplement",
			"Set max_daily_doses: 1",
			"Submit",
			"Verify person medicine created",
			"Click Take Medicine",
			"Verify dose recorded",
			"Verify button now disabled",
			"Verify message shows limit reached",
			"Navigate to medication history",
			"Verify dose appears with timestamp",
			"Verify administered_by shows parent name",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-005",
		"category": "functional",
		"area": "e2e",
		"description": "Admin reviews complete audit trail for user lifecycle",
		"steps": [
			"Log in as administrator",
			"Navigate to /admin/users/new",
			"Create new user with nurse role",
			"Submit",
			"Note user ID",
			"Navigate to /admin/users",
			"Find new user",
			"Click Edit",
			"Change role to doctor",
			"Submit",
			"Navigate to /admin/audit_logs",
			"Filter by record type: User",
			"Verify create event logged",
			"Verify update event logged",
			"Click on update event",
			"Verify previous state shows nurse role",
			"Verify new state shows doctor role",
			"Verify whodunnit shows admin user",
			"Verify IP address recorded",
			"Filter by event type: update",
			"Verify only update events shown",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-006",
		"category": "functional",
		"area": "e2e",
		"description": "Nurse records medications for multiple patients in shift",
		"steps": [
			"Log in as nurse (nurse.smith@example.com)",
			"Navigate to dashboard",
			"Verify all patients visible",
			"Select first patient with active prescription",
			"Navigate to prescription",
			"Click Take Medicine",
			"Add notes: Morning round",
			"Submit",
			"Verify recorded",
			"Navigate back to dashboard",
			"Select second patient with active prescription",
			"Navigate to prescription",
			"Click Take Medicine",
			"Add notes: Morning round",
			"Submit",
			"Verify recorded",
			"Navigate to first patient medication history",
			"Verify dose recorded with nurse as administered_by",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-007",
		"category": "functional",
		"area": "e2e",
		"description": "Admin dashboard shows accurate metrics and warnings",
		"steps": [
			"Log in as administrator",
			"Navigate to /admin/dashboard",
			"Verify total users by role displayed",
			"Verify administrator count matches database",
			"Verify doctor count matches database",
			"Verify nurse count matches database",
			"Verify carer count matches database",
			"Verify parent count matches database",
			"Verify total people by type displayed",
			"Verify adult count matches database",
			"Verify minor count matches database",
			"Verify dependent_adult count matches database",
			"Verify recent signups (last 7 days) shown",
			"Verify active users count displayed",
			"Create patient without capacity and no carer",
			"Refresh dashboard",
			"Verify warning displayed for patient without carer",
			"Click quick link to manage users",
			"Verify navigates to /admin/users",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-008",
		"category": "functional",
		"area": "e2e",
		"description": "Complete prescription lifecycle from creation to deactivation",
		"steps": [
			"Log in as doctor",
			"Navigate to /people",
			"Select existing patient",
			"Navigate to prescriptions",
			"Click New Prescription",
			"Select medicine: Ibuprofen",
			"Set dosage: 200mg",
			"Set frequency: Three times daily",
			"Set start_date: today",
			"Set end_date: 30 days from now",
			"Set max_daily_doses: 3",
			"Set special_instructions: Take with food",
			"Submit",
			"Verify prescription created",
			"Navigate to prescription details",
			"Verify all fields displayed correctly",
			"Click Edit",
			"Change dosage to 400mg",
			"Submit",
			"Verify changes saved",
			"Click Deactivate",
			"Confirm deactivation",
			"Verify marked inactive",
			"Navigate to prescription list",
			"Verify inactive prescription not in active list",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-009",
		"category": "functional",
		"area": "e2e",
		"description": "Carer relationship management and access control verification",
		"steps": [
			"Log in as administrator",
			"Navigate to carer relationships",
			"Click New Relationship",
			"Select carer: bob.smith@example.com",
			"Select patient: existing dependent adult",
			"Select relationship type: Family member",
			"Submit",
			"Verify relationship created",
			"Log out",
			"Log in as bob.smith@example.com (carer)",
			"Navigate to dashboard",
			"Verify patient visible",
			"Navigate to patient details",
			"Verify can view patient information",
			"Navigate to patient prescriptions",
			"Verify can view prescriptions",
			"Click Take Medicine",
			"Verify can record medication",
			"Log out",
			"Log in as administrator",
			"Navigate to carer relationships",
			"Find relationship",
			"Click Deactivate",
			"Confirm",
			"Verify marked inactive",
			"Log out",
			"Log in as bob.smith@example.com",
			"Navigate to dashboard",
			"Verify patient no longer visible",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-010",
		"category": "functional",
		"area": "e2e",
		"description": "Medicine management and prescription integration",
		"steps": [
			"Log in as administrator",
			"Navigate to /medicines",
			"Click New Medicine",
			"Fill name: Test Antibiotic",
			"Fill description: For testing purposes",
			"Fill standard_dosage: 250mg",
			"Fill warnings: May cause drowsiness",
			"Submit",
			"Verify medicine created",
			"Navigate to /people",
			"Select patient",
			"Navigate to prescriptions",
			"Click New Prescription",
			"Verify Test Antibiotic appears in dropdown",
			"Select Test Antibiotic",
			"Complete prescription form",
			"Submit",
			"Verify prescription created with Test Antibiotic",
			"Navigate back to /medicines",
			"Find Test Antibiotic",
			"Click Edit",
			"Set active: false",
			"Submit",
			"Navigate to patient prescriptions",
			"Click New Prescription",
			"Verify Test Antibiotic NOT in dropdown",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-011",
		"category": "functional",
		"area": "e2e",
		"description": "Daily dose reset at midnight verification",
		"steps": [
			"Log in as carer with assigned patient",
			"Navigate to patient prescription with max_daily_doses: 2",
			"Click Take Medicine",
			"Verify dose 1 recorded",
			"Click Take Medicine",
			"Verify dose 2 recorded",
			"Attempt Take Medicine again",
			"Verify blocked - daily limit reached",
			"Verify message shows 2/2 doses taken",
			"Advance system time to next day (midnight)",
			"Refresh page",
			"Verify Take Medicine button enabled",
			"Verify message shows 0/2 doses taken",
			"Click Take Medicine",
			"Verify dose recorded for new day",
			"Log out"
		],
		"passes": false
	},
	{
		"id": "E2E-012",
		"category": "functional",
		"area": "e2e",
		"description": "Person type and capacity validation flow",
		"steps": [
			"Log in as administrator",
			"Navigate to /people/new",
			"Fill name: Test Minor",
			"Fill date_of_birth: 10 years ago",
			"Select person_type: minor",
			"Verify has_capacity defaults to false or is disabled",
			"Submit",
			"Verify person created",
			"Verify needs_carer? returns true",
			"Navigate to carer relationships",
			"Create relationship with parent",
			"Navigate back to person",
			"Verify needs_carer? now returns false",
			"Navigate to /people/new",
			"Fill name: Test Dependent Adult",
			"Fill date_of_birth: 40 years ago",
			"Select person_type: dependent_adult",
			"Set has_capacity: false",
			"Submit",
			"Verify person created",
			"Verify needs_carer? returns true",
			"Navigate to admin dashboard",
			"Verify warning shows for patients without carers",
			"Log out"
		],
		"passes": false
	}
]
